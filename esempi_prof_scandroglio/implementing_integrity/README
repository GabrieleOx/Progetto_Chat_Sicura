In classe abbiamo visto che per garantire integrità dei messaggi li si può firmare.
Questo è vero ma è molto lento (dato che la firma utilizza algoritmi asimmetrici).

Quello che solitamente si fa per garantire integrità è usare un HMAC.
Un HMAC è una specie di digest del messaggio, che però non è da calcolare con una funzione di hash (questo potrebbe farlo anche un'attaccante).

Quello che si fa è calcolare il digest usando un algoritmo simmetrico con una determinata chiave (nota solamente agli interlocutori).
Si calcola il digest del messaggio e si appende il digest in coda al messagio prima di cifrare il tutto con un algoritmo simmetrico (che ovviamente utilizza una 
chiave diversa rispetto a quella usata per calcolare il digest).

Potete andare a vedere come implementare il meccanismo di integrità HMAC su https://pycryptodome.readthedocs.io/en/latest/src/hash/hmac.html
Altrimenti abbiamo la funzione encrypt_and_digest di AES